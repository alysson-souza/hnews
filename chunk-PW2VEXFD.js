import{a as N,b as A}from"./chunk-6AL6K6VM.js";import{a as V}from"./chunk-5TWKKEAL.js";import{a as z}from"./chunk-3BCHM5BW.js";import"./chunk-ENKPNR3A.js";import{b as T,h as S}from"./chunk-KL6MQSIY.js";import{a as L}from"./chunk-QI6MRUE2.js";import"./chunk-D6CZUGXV.js";import{a as E}from"./chunk-HQSEDM7A.js";import{a as D}from"./chunk-WR545DO4.js";import{$a as f,Ba as _,Db as w,Na as y,Pa as h,Pb as O,Qa as g,Ra as x,Sa as M,Ta as P,Ua as v,Va as i,Wa as a,Xa as m,Z as p,ba as u,bb as k,ca as b,db as s,ka as d,ob as c,pb as I,qb as C,va as n}from"./chunk-4BF6OBRF.js";function B(o,t){o&1&&(i(0,"div",0),m(1,"div",2)(2,"div",3),i(3,"div",4),m(4,"div",5)(5,"div",5),a()())}function R(o,t){if(o&1&&m(0,"app-comment-thread",13),o&2){let e=t.$implicit;v("commentId",e)("depth",0)}}function F(o,t){if(o&1){let e=f();i(0,"div",14)(1,"app-button",15),k("clicked",function(){u(e);let l=s(3);return b(l.loadMoreTopLevelComments())}),c(2),a()()}if(o&2){let e=s(3);n(),y("ariaLabel","Load more comments"),n(),C(" Load ",e.remainingTopLevelCount()," more comments ")}}function j(o,t){if(o&1&&(i(0,"div",12),M(1,R,1,2,"app-comment-thread",13,x),a(),h(3,F,3,2,"div",14)),o&2){let e=s(2);n(),P(e.visibleCommentIds()),n(2),g(e.hasMoreTopLevelComments()?3:-1)}}function Y(o,t){o&1&&(i(0,"p",11),c(1,"No comments yet"),a())}function $(o,t){if(o&1&&(i(0,"app-card",6),m(1,"app-visited-indicator",7)(2,"app-sidebar-story-summary",8),a(),i(3,"app-card",9)(4,"h2",10),c(5),a(),h(6,j,4,1)(7,Y,2,0,"p",11),a()),o&2){let e=s();n(),v("storyId",e.item().id),n(),v("item",e.item())("showActions",!1),n(3),C("Comments (",e.item().descendants||0,")"),n(),g(e.item().kids&&e.item().kids.length>0?6:7)}}function G(o,t){if(o&1){let e=f();i(0,"div",1)(1,"p",16),c(2),a(),i(3,"button",17),k("click",function(){u(e);let l=s();return b(l.loadItem())}),c(4,"Try Again"),a()()}if(o&2){let e=s();n(2),I(e.error())}}var H=class o{route=p(T);hnService=p(S);visitedService=p(z);item=d(null);loading=d(!0);error=d(null);commentsPageSize=10;visibleTopLevelCount=d(this.commentsPageSize);visibleCommentIds=w(()=>{let t=this.item()?.kids??[],e=Math.min(this.visibleTopLevelCount(),t.length);return t.slice(0,e)});hasMoreTopLevelComments=w(()=>(this.item()?.kids?.length??0)>this.visibleCommentIds().length);remainingTopLevelCount=w(()=>{let t=this.item()?.kids?.length??0,e=this.visibleCommentIds().length,r=Math.max(t-e,0);return Math.min(this.commentsPageSize,r)});ngOnInit(){this.route.params.subscribe(t=>{let e=t.id;e?this.loadItem(+e):this.route.queryParams.subscribe(r=>{let l=r.id;l&&this.loadItem(+l)})})}loadItem(t){let e=t||+this.route.snapshot.params.id;if(!e){this.error.set("Invalid item ID"),this.loading.set(!1);return}this.loading.set(!0),this.error.set(null),this.visibleTopLevelCount.set(this.commentsPageSize),this.hnService.getItem(e).subscribe({next:r=>{r?(this.item.set(r),this.visitedService.markAsVisited(r.id,r.descendants),setTimeout(()=>{let l=document.getElementById("submission-title");if(l){let q=l.getBoundingClientRect().top+window.scrollY-80;window.scrollTo({top:Math.max(0,q),behavior:"smooth"})}},100)):this.error.set("Item not found"),this.loading.set(!1)},error:()=>{this.error.set("Failed to load item. Please try again."),this.loading.set(!1)}})}loadMoreTopLevelComments(){let t=this.item()?.kids?.length??0;!this.hasMoreTopLevelComments()||t===0||this.visibleTopLevelCount.update(e=>{let r=e+this.commentsPageSize;return Math.min(r,t)})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=_({type:o,selectors:[["app-item"]],decls:4,vars:1,consts:[[1,"animate-pulse"],[1,"error-card"],[1,"skel-title","mb-4"],[1,"skel-subtitle","mb-8"],[1,"space-y-4"],[1,"skel-block"],["id","submission-title",1,"block","mb-6"],[3,"storyId"],[3,"item","showActions"],[1,"block"],[1,"comments-title"],[1,"empty"],["role","tree","aria-label","Comments",1,"space-y-4"],[3,"commentId","depth"],[1,"mt-6","flex","justify-center"],["variant","secondary","size","sm",3,"clicked","ariaLabel"],[1,"error-text"],[1,"error-btn",3,"click"]],template:function(e,r){e&1&&(i(0,"app-page-container"),h(1,B,6,0,"div",0)(2,$,8,5)(3,G,5,1,"div",1),a()),e&2&&(n(),g(r.loading()?1:r.item()?2:r.error()?3:-1))},dependencies:[O,N,D,E,V,A,L],styles:[`@layer properties;.skel-title[_ngcontent-%COMP%]{height:calc(var(--spacing, .25rem) * 8);width:75%;border-radius:.25rem;background-color:var(--color-gray-200, oklch(92.8% .006 264.531))}.skel-title[_ngcontent-%COMP%]:where(.dark,.dark *){background-color:var(--color-slate-800, oklch(27.9% .041 260.031))}.skel-subtitle[_ngcontent-%COMP%]{height:calc(var(--spacing, .25rem) * 4);width:50%;border-radius:.25rem;background-color:var(--color-gray-200, oklch(92.8% .006 264.531))}.skel-subtitle[_ngcontent-%COMP%]:where(.dark,.dark *){background-color:var(--color-slate-800, oklch(27.9% .041 260.031))}.skel-block[_ngcontent-%COMP%]{height:calc(var(--spacing, .25rem) * 20);border-radius:.25rem;background-color:var(--color-gray-200, oklch(92.8% .006 264.531))}.skel-block[_ngcontent-%COMP%]:where(.dark,.dark *){background-color:var(--color-slate-800, oklch(27.9% .041 260.031))}.item-title[_ngcontent-%COMP%]{margin-bottom:calc(var(--spacing, .25rem) * 2);font-size:var(--text-2xl, 1.5rem);line-height:var(--tw-leading, var(--text-2xl--line-height, calc(2 / 1.5)));--tw-font-weight: var(--font-weight-bold, 700);font-weight:var(--font-weight-bold, 700);color:var(--color-gray-900, oklch(21% .034 264.665))}.item-title[_ngcontent-%COMP%]:where(.dark,.dark *){color:var(--color-gray-100, oklch(96.7% .003 264.542))}.comments-title[_ngcontent-%COMP%]{margin-bottom:calc(var(--spacing, .25rem) * 4);font-size:var(--text-xl, 1.25rem);line-height:var(--tw-leading, var(--text-xl--line-height, calc(1.75 / 1.25)));--tw-font-weight: var(--font-weight-semibold, 600);font-weight:var(--font-weight-semibold, 600);color:var(--color-gray-900, oklch(21% .034 264.665))}.comments-title[_ngcontent-%COMP%]:where(.dark,.dark *){color:var(--color-gray-100, oklch(96.7% .003 264.542))}@media (hover: hover){.title-link[_ngcontent-%COMP%]:hover{color:var(--color-blue-600, oklch(54.6% .245 262.881))}}@media (hover: hover){.title-link[_ngcontent-%COMP%]:where(.dark,.dark *):hover{color:var(--color-blue-400, oklch(70.7% .165 254.624))}}.dead-item[_ngcontent-%COMP%]{color:var(--color-gray-500, oklch(55.1% .027 264.364));font-style:italic}.dead-item[_ngcontent-%COMP%]:where(.dark,.dark *){color:var(--color-gray-600, oklch(44.6% .03 256.802))}.item-meta[_ngcontent-%COMP%]{display:flex;align-items:center;gap:calc(var(--spacing, .25rem) * 3);font-size:var(--text-sm, .875rem);line-height:var(--tw-leading, var(--text-sm--line-height, calc(1.25 / .875)));color:var(--color-gray-600, oklch(44.6% .03 256.802))}.item-meta[_ngcontent-%COMP%]:where(.dark,.dark *){color:var(--color-gray-400, oklch(70.7% .022 261.325))}.meta-link[_ngcontent-%COMP%]{color:var(--color-blue-600, oklch(54.6% .245 262.881))}@media (hover: hover){.meta-link[_ngcontent-%COMP%]:hover{text-decoration-line:underline}}.meta-link[_ngcontent-%COMP%]:where(.dark,.dark *){color:var(--color-blue-300, oklch(80.9% .105 251.813))}.item-prose[_ngcontent-%COMP%]{margin-bottom:calc(var(--spacing, .25rem) * 4);color:var(--tw-prose-body);max-width:65ch;--tw-prose-body: #374151;--tw-prose-headings: #111827;--tw-prose-lead: #4b5563;--tw-prose-links: #111827;--tw-prose-bold: #111827;--tw-prose-counters: #6b7280;--tw-prose-bullets: #d1d5db;--tw-prose-hr: #e5e7eb;--tw-prose-quotes: #111827;--tw-prose-quote-borders: #e5e7eb;--tw-prose-captions: #6b7280;--tw-prose-code: #111827;--tw-prose-pre-code: #e5e7eb;--tw-prose-pre-bg: #1f2937;--tw-prose-th-borders: #d1d5db;--tw-prose-td-borders: #e5e7eb;max-width:none;font-size:1.125rem;line-height:1.7777778;color:var(--color-gray-800, oklch(27.8% .033 256.848))}.item-prose[_ngcontent-%COMP%]:where(.dark,.dark *){color:var(--color-gray-200, oklch(92.8% .006 264.531))}.empty[_ngcontent-%COMP%]{padding-block:calc(var(--spacing, .25rem) * 8);text-align:center;color:var(--color-gray-500, oklch(55.1% .027 264.364))}.empty[_ngcontent-%COMP%]:where(.dark,.dark *){color:var(--color-gray-400, oklch(70.7% .022 261.325))}.error-card[_ngcontent-%COMP%]{border-radius:var(--radius-lg, .5rem);border-style:var(--tw-border-style);border-width:1px;border-color:var(--color-red-200, oklch(88.5% .062 18.334));background-color:var(--color-red-50, oklch(97.1% .013 17.38));padding:calc(var(--spacing, .25rem) * 6);text-align:center}.error-card[_ngcontent-%COMP%]:where(.dark,.dark *){border-color:var(--color-red-800, oklch(44.4% .177 26.899))}.error-card[_ngcontent-%COMP%]:where(.dark,.dark *){background-color:color-mix(in srgb,oklch(39.6% .141 25.723) 30%,transparent)}@supports (color: color-mix(in lab,red,red)){.error-card[_ngcontent-%COMP%]:where(.dark,.dark *){background-color:color-mix(in oklab,var(--color-red-900, oklch(39.6% .141 25.723)) 30%,transparent)}}.error-text[_ngcontent-%COMP%]{color:var(--color-red-800, oklch(44.4% .177 26.899))}.error-text[_ngcontent-%COMP%]:where(.dark,.dark *){color:var(--color-red-300, oklch(80.8% .114 19.571))}.error-btn[_ngcontent-%COMP%]{margin-top:calc(var(--spacing, .25rem) * 4);border-radius:.25rem;background-color:var(--color-red-600, oklch(57.7% .245 27.325));padding-inline:calc(var(--spacing, .25rem) * 4);padding-block:calc(var(--spacing, .25rem) * 2);color:var(--color-white, #fff)}@media (hover: hover){.error-btn[_ngcontent-%COMP%]:hover{background-color:var(--color-red-700, oklch(50.5% .213 27.518))}}.error-btn[_ngcontent-%COMP%]:focus-visible{--tw-ring-shadow: var(--tw-ring-inset,) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color, currentcolor);box-shadow:var(--tw-inset-shadow),var(--tw-inset-ring-shadow),var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow)}.error-btn[_ngcontent-%COMP%]:focus-visible{--tw-ring-color: var(--color-red-500, oklch(63.7% .237 25.331))}.error-btn[_ngcontent-%COMP%]:focus-visible{--tw-outline-style: none;outline-style:none}app-card[_ngcontent-%COMP%]{position:relative}@property --tw-font-weight{syntax: "*"; inherits: false;}@property --tw-border-style{syntax: "*"; inherits: false; initial-value: solid;}@property --tw-shadow{syntax: "*"; inherits: false; initial-value: 0 0 #0000;}@property --tw-shadow-color{syntax: "*"; inherits: false;}@property --tw-shadow-alpha{syntax: "<percentage>"; inherits: false; initial-value: 100%;}@property --tw-inset-shadow{syntax: "*"; inherits: false; initial-value: 0 0 #0000;}@property --tw-inset-shadow-color{syntax: "*"; inherits: false;}@property --tw-inset-shadow-alpha{syntax: "<percentage>"; inherits: false; initial-value: 100%;}@property --tw-ring-color{syntax: "*"; inherits: false;}@property --tw-ring-shadow{syntax: "*"; inherits: false; initial-value: 0 0 #0000;}@property --tw-inset-ring-color{syntax: "*"; inherits: false;}@property --tw-inset-ring-shadow{syntax: "*"; inherits: false; initial-value: 0 0 #0000;}@property --tw-ring-inset{syntax: "*"; inherits: false;}@property --tw-ring-offset-width{syntax: "<length>"; inherits: false; initial-value: 0px;}@property --tw-ring-offset-color{syntax: "*"; inherits: false; initial-value: #fff;}@property --tw-ring-offset-shadow{syntax: "*"; inherits: false; initial-value: 0 0 #0000;}@layer properties{@supports ((-webkit-hyphens: none) and (not (margin-trim: inline))) or ((-moz-orient: inline) and (not (color:rgb(from red r g b)))){*[_ngcontent-%COMP%], [_ngcontent-%COMP%]:before, [_ngcontent-%COMP%]:after, [_ngcontent-%COMP%]::backdrop{--tw-font-weight: initial;--tw-border-style: solid;--tw-shadow: 0 0 #0000;--tw-shadow-color: initial;--tw-shadow-alpha: 100%;--tw-inset-shadow: 0 0 #0000;--tw-inset-shadow-color: initial;--tw-inset-shadow-alpha: 100%;--tw-ring-color: initial;--tw-ring-shadow: 0 0 #0000;--tw-inset-ring-color: initial;--tw-inset-ring-shadow: 0 0 #0000;--tw-ring-inset: initial;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-offset-shadow: 0 0 #0000}}}

`]})};export{H as ItemComponent};
