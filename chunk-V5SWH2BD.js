import{V as g,a as n,b as i,na as c}from"./chunk-VQVH6RQB.js";var p=class s{STORAGE_KEY="hn_user_tags";tagsMap=c(new Map);DEFAULT_COLORS=["#EF4444","#F97316","#EAB308","#22C55E","#14B8A6","#3B82F6","#8B5CF6","#EC4899","#6B7280"];constructor(){this.loadTags()}loadTags(){try{let t=localStorage.getItem(this.STORAGE_KEY);if(t){let a=JSON.parse(t),r=new Map;a.forEach(e=>r.set(e.username,e)),this.tagsMap.set(r)}}catch(t){console.error("Failed to load user tags:",t)}}saveTags(){try{let t=Array.from(this.tagsMap().values());localStorage.setItem(this.STORAGE_KEY,JSON.stringify(t))}catch(t){console.error("Failed to save user tags:",t)}}setTag(t,a,r){let e=Date.now(),l=this.tagsMap().get(t),d={username:t,tag:a,color:r||this.getRandomColor(),createdAt:l?.createdAt||e,updatedAt:e},o=new Map(this.tagsMap());o.set(t,d),this.tagsMap.set(o),this.saveTags()}getTag(t){return this.tagsMap().get(t)}removeTag(t){let a=new Map(this.tagsMap());a.delete(t),this.tagsMap.set(a),this.saveTags()}getAllTags(){return Array.from(this.tagsMap().values())}getRandomColor(){return this.DEFAULT_COLORS[Math.floor(Math.random()*this.DEFAULT_COLORS.length)]}exportTags(){let t=this.getAllTags();return JSON.stringify(t,null,2)}importTags(t){try{let a=JSON.parse(t);if(!Array.isArray(a))throw new Error("Invalid format: expected an array");for(let e of a)if(!e.username||!e.tag)throw new Error("Invalid tag format");let r=new Map(this.tagsMap());return a.forEach(e=>{r.set(e.username,i(n({},e),{createdAt:e.createdAt||Date.now(),updatedAt:e.updatedAt||Date.now(),color:e.color||this.getRandomColor()}))}),this.tagsMap.set(r),this.saveTags(),!0}catch(a){return console.error("Failed to import tags:",a),!1}}clearAllTags(){this.tagsMap.set(new Map),localStorage.removeItem(this.STORAGE_KEY)}static \u0275fac=function(a){return new(a||s)};static \u0275prov=g({token:s,factory:s.\u0275fac,providedIn:"root"})};export{p as a};
