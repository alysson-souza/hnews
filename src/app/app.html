<app-shell
  [offline]="isOffline()"
  [showOfflineBanner]="showOfflineMessage()"
  [routerUrl]="router.url"
  [searchQuery]="searchQuery"
  [mobileMenuOpen]="mobileMenuOpen()"
  [showMobileSearch]="showMobileSearch()"
  [commitShaShort]="commitShaShort"
  [commitUrl]="commitUrl"
  (searchQueryChange)="searchQuery = $event"
  (searchSubmit)="search()"
  (desktopSearchKeydown)="handleDesktopSearchKeydown($event)"
  (menuToggleRequested)="toggleMobileMenu()"
  (searchToggleRequested)="toggleMobileSearch()"
  (closeMenuRequested)="closeMobileMenu()"
>
  <router-outlet shellMain></router-outlet>
</app-shell>

<!-- PWA Update Indicator -->
@if (updateAvailable()) {
  <div
    class="fixed top-32 left-1/2 -translate-x-1/2 z-50 bg-green-600 hover:bg-green-700 dark:bg-green-500 dark:hover:bg-green-600 text-white px-6 py-3 rounded-full shadow-lg dark:shadow-gray-800/50 transition-all duration-200 cursor-pointer focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-green-500 focus-visible:ring-offset-2 dark:focus-visible:ring-offset-gray-900 font-medium text-sm animate-bounce flex items-center gap-3"
    (click)="applyPwaUpdate()"
    role="button"
    aria-label="Apply app update"
    tabindex="0"
    (keydown.enter)="applyPwaUpdate()"
    (keydown.space)="applyPwaUpdate()"
  >
    <span>ğŸ”„</span>
    <span>App update available</span>
    <span class="text-xs opacity-75">(Press R to apply)</span>
  </div>
}

<app-sidebar-comments></app-sidebar-comments>
<app-scroll-to-top></app-scroll-to-top>
<app-keyboard-shortcuts></app-keyboard-shortcuts>
