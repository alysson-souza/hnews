<app-shell
  [offline]="isOffline()"
  [routerUrl]="router.url"
  [searchQuery]="searchQuery"
  [mobileMenuOpen]="mobileMenuOpen()"
  [showMobileSearch]="showMobileSearch()"
  [commitShaShort]="commitShaShort"
  [commitUrl]="commitUrl"
  (searchQueryChange)="searchQuery = $event"
  (searchSubmit)="search()"
  (desktopSearchKeydown)="handleDesktopSearchKeydown($event)"
  (menuToggleRequested)="toggleMobileMenu()"
  (searchToggleRequested)="toggleMobileSearch()"
  (closeMenuRequested)="closeMobileMenu()"
>
  <router-outlet shellMain />
</app-shell>

<!-- PWA Update Indicator -->
@if (updateAvailable()) {
  <button (click)="applyPwaUpdate()" class="update-indicator" aria-label="Apply app update">
    Update available
  </button>
}

@defer (when sidebarService.currentItemId()) {
  <app-sidebar-comments />
}
<app-scroll-to-top />
<app-keyboard-shortcuts />
