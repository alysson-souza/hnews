<app-shell
  [offline]="isOffline()"
  [routerUrl]="router.url"
  [searchQuery]="searchQuery"
  [mobileMenuOpen]="mobileMenuOpen()"
  [showMobileSearch]="showMobileSearch()"
  [commitShaShort]="commitShaShort"
  [commitUrl]="commitUrl"
  (searchQueryChange)="searchQuery = $event"
  (searchSubmit)="search()"
  (desktopSearchKeydown)="handleDesktopSearchKeydown($event)"
  (menuToggleRequested)="toggleMobileMenu()"
  (searchToggleRequested)="toggleMobileSearch()"
  (closeMenuRequested)="closeMobileMenu()"
>
  <router-outlet shellMain></router-outlet>
</app-shell>

<!-- PWA Update Indicator -->
@if (updateAvailable()) {
  <button
    (click)="applyPwaUpdate()"
    class="fixed top-20 left-1/2 -translate-x-1/2 z-50 bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600 text-white px-4 py-2 rounded-full shadow-lg dark:shadow-gray-800/50 transition-all duration-200 cursor-pointer focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 dark:focus-visible:ring-offset-gray-900 font-medium text-sm animate-bounce"
    aria-label="Apply app update"
  >
    Update available
  </button>
}

<app-sidebar-comments></app-sidebar-comments>
<app-scroll-to-top></app-scroll-to-top>
<app-keyboard-shortcuts></app-keyboard-shortcuts>
