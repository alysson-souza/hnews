import{e as $,h as F,k as P}from"./chunk-WSP23YN7.js";import{a as z}from"./chunk-ALJNL3AC.js";import{$a as _,Aa as I,Ab as b,Ba as k,Bb as v,Ea as a,Ib as h,Ma as N,_ as y,_b as L,ab as x,cb as D,da as M,db as H,ea as E,eb as u,fb as r,gb as o,hb as f,lb as U,na as c,nb as w,pb as l,y as S,zb as s}from"./chunk-A2HHJ6P6.js";var T=t=>["/item",t],A=(t,i)=>i.id;function q(t,i){t&1&&(r(0,"div",0),f(1,"div",2)(2,"div",3)(3,"div",4),r(4,"div",5),f(5,"div",6)(6,"div",6),o()())}function O(t,i){if(t&1&&(r(0,"div",13)(1,"h2",18),s(2,"About"),o(),f(3,"div",19),o()),t&2){let e=l(2);a(3),u("innerHTML",e.user().about,I)}}function R(t,i){t&1&&(r(0,"div",16),f(1,"div",20)(2,"div",20)(3,"div",20),o())}function j(t,i){if(t&1&&(r(0,"a",24),s(1),o()),t&2){let e=l(2).$implicit;u("href",e.url,k),a(),v(" ",e.title," ")}}function J(t,i){if(t&1&&(r(0,"a",25),s(1),o()),t&2){let e=l(2).$implicit;u("routerLink",h(2,T,e.id)),a(),v(" ",e.title," ")}}function K(t,i){if(t&1&&(r(0,"div")(1,"h3",23),_(2,j,2,2,"a",24)(3,J,2,4,"a",25),o(),r(4,"div",26)(5,"span"),s(6),o(),r(7,"span"),s(8,"\u2022"),o(),r(9,"span"),s(10),o(),r(11,"span"),s(12,"\u2022"),o(),r(13,"a",27),s(14),o()()()),t&2){let e=l().$implicit,n=l(3);a(2),x(e.url?2:3),a(4),v("",e.score||0," points"),a(4),b(n.getTimeAgo(e.time)),a(3),u("routerLink",h(5,T,e.id)),a(),v(" ",e.descendants||0," comments ")}}function B(t,i){if(t&1&&(r(0,"div"),f(1,"div",28),r(2,"div",26)(3,"span"),s(4),o(),r(5,"span"),s(6,"\u2022"),o(),r(7,"a",27),s(8," View Context "),o()()()),t&2){let e=l().$implicit,n=l(3);a(),u("innerHTML",e.text,I),a(3),b(n.getTimeAgo(e.time)),a(3),u("routerLink",h(3,T,e.parent))}}function G(t,i){if(t&1&&(r(0,"div",21),_(1,K,15,7,"div")(2,B,9,5,"div"),o()),t&2){let e=i.$implicit;a(),x(e.type==="story"?1:e.type==="comment"?2:-1)}}function Q(t,i){if(t&1){let e=U();r(0,"button",29),w("click",function(){M(e);let d=l(3);return E(d.loadMoreSubmissions())}),s(1),o()}if(t&2){let e=l(3);u("disabled",e.loadingMore()),a(),v(" ",e.loadingMore()?"Loading...":"Load More"," ")}}function W(t,i){if(t&1&&(r(0,"div",5),D(1,G,3,1,"div",21,A),o(),_(3,Q,2,2,"button",22)),t&2){let e=l(2);a(),H(e.submissions()),a(2),x(e.hasMore()?3:-1)}}function X(t,i){t&1&&(r(0,"p",17),s(1,"No submissions yet"),o())}function Y(t,i){if(t&1&&(r(0,"div",7)(1,"h1",8),s(2),o(),r(3,"div",9)(4,"div",10)(5,"div",11),s(6,"Karma"),o(),r(7,"div",12),s(8),o()(),r(9,"div",10)(10,"div",11),s(11,"Member Since"),o(),r(12,"div",12),s(13),o()(),r(14,"div",10)(15,"div",11),s(16,"Submissions"),o(),r(17,"div",12),s(18),o()()(),_(19,O,4,1,"div",13),o(),r(20,"div",14)(21,"h2",15),s(22,"Recent Submissions"),o(),_(23,R,4,0,"div",16)(24,W,4,1)(25,X,2,0,"p",17),o()),t&2){let e,n=l();a(2),b(n.user().id),a(6),b(n.user().karma),a(5),b(n.getDate(n.user().created)),a(5),v(" ",((e=n.user().submitted)==null?null:e.length)||0," "),a(),x(n.user().about?19:-1),a(4),x(n.loadingSubmissions()?23:n.submissions().length>0?24:25)}}function Z(t,i){if(t&1){let e=U();r(0,"div",1)(1,"p",30),s(2),o(),r(3,"button",31),w("click",function(){M(e);let d=l();return E(d.loadUser())}),s(4," Try Again "),o()()}if(t&2){let e=l();a(2),b(e.error())}}var V=class t{route=y($);hnService=y(P);user=c(null);submissions=c([]);loading=c(!0);loadingSubmissions=c(!0);loadingMore=c(!1);error=c(null);currentPage=c(0);pageSize=20;ngOnInit(){this.route.params.subscribe(i=>{let e=i.id;e?this.loadUser(e):this.route.queryParams.subscribe(n=>{let d=n.id;d&&this.loadUser(d)})})}loadUser(i){let e=i||this.route.snapshot.params.id;if(!e){this.error.set("Invalid user ID"),this.loading.set(!1);return}this.loading.set(!0),this.error.set(null),this.hnService.getUser(e).subscribe({next:n=>{n?(this.user.set(n),this.loadSubmissions(n)):this.error.set("User not found"),this.loading.set(!1)},error:()=>{this.error.set("Failed to load user. Please try again."),this.loading.set(!1)}})}loadSubmissions(i){if(!i.submitted||i.submitted.length===0){this.loadingSubmissions.set(!1);return}this.loadingSubmissions.set(!0);let e=0,n=Math.min(this.pageSize,i.submitted.length),p=i.submitted.slice(e,n).map(g=>this.hnService.getItem(g));S(p).subscribe({next:g=>{let C=g.filter(m=>m!==null&&!m.deleted);this.submissions.set(C),this.loadingSubmissions.set(!1),this.currentPage.set(1)},error:()=>{this.loadingSubmissions.set(!1)}})}loadMoreSubmissions(){let i=this.user();if(!i||!i.submitted)return;this.loadingMore.set(!0);let e=this.currentPage()*this.pageSize,n=Math.min(e+this.pageSize,i.submitted.length),p=i.submitted.slice(e,n).map(g=>this.hnService.getItem(g));S(p).subscribe({next:g=>{let C=g.filter(m=>m!==null&&!m.deleted);this.submissions.update(m=>[...m,...C]),this.loadingMore.set(!1),this.currentPage.update(m=>m+1)},error:()=>{this.loadingMore.set(!1)}})}hasMore(){let i=this.user();return!i||!i.submitted?!1:this.currentPage()*this.pageSize<i.submitted.length}getTimeAgo(i){let e=Math.floor(Date.now()/1e3-i),n=Math.floor(e/60),d=Math.floor(n/60),p=Math.floor(d/24);return p>0?`${p} day${p>1?"s":""} ago`:d>0?`${d} hour${d>1?"s":""} ago`:n>0?`${n} minute${n>1?"s":""} ago`:"just now"}getDate(i){return new Date(i*1e3).toLocaleDateString()}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=N({type:t,selectors:[["app-user"]],decls:4,vars:1,consts:[[1,"animate-pulse"],[1,"bg-red-50","border","border-red-200","rounded-lg","p-6","text-center"],[1,"h-8","bg-gray-200","rounded","w-1/4","mb-4"],[1,"h-4","bg-gray-200","rounded","w-1/2","mb-2"],[1,"h-4","bg-gray-200","rounded","w-3/4","mb-8"],[1,"space-y-4"],[1,"h-20","bg-gray-200","rounded"],[1,"bg-white","rounded-lg","shadow-sm","p-6","mb-6"],[1,"text-2xl","font-bold","text-gray-900","mb-4"],[1,"grid","grid-cols-2","md:grid-cols-3","gap-4","mb-6"],[1,"bg-gray-50","rounded","p-3"],[1,"text-sm","text-gray-600"],[1,"text-xl","font-semibold","text-gray-900"],[1,"mb-6"],[1,"bg-white","rounded-lg","shadow-sm","p-6"],[1,"text-xl","font-semibold","text-gray-900","mb-4"],[1,"animate-pulse","space-y-4"],[1,"text-gray-500","text-center","py-8"],[1,"text-lg","font-semibold","text-gray-900","mb-2"],[1,"prose","prose-sm","max-w-none","text-gray-800",3,"innerHTML"],[1,"h-16","bg-gray-200","rounded"],[1,"border-b","border-gray-200","pb-4","last:border-0"],[1,"mt-6","w-full","py-2","px-4","bg-blue-600","text-white","rounded","hover:bg-blue-700","disabled:opacity-50",3,"disabled"],[1,"font-medium","text-gray-900","mb-1"],["target","_blank","rel","noopener noreferrer",1,"hover:text-blue-600",3,"href"],[1,"hover:text-blue-600",3,"routerLink"],[1,"flex","items-center","gap-3","text-sm","text-gray-600"],[1,"text-blue-600","hover:underline",3,"routerLink"],[1,"prose","prose-sm","max-w-none","text-gray-800","mb-2","line-clamp-3",3,"innerHTML"],[1,"mt-6","w-full","py-2","px-4","bg-blue-600","text-white","rounded","hover:bg-blue-700","disabled:opacity-50",3,"click","disabled"],[1,"text-red-800"],[1,"mt-4","px-4","py-2","bg-red-600","text-white","rounded","hover:bg-red-700",3,"click"]],template:function(e,n){e&1&&(r(0,"app-page-container"),_(1,q,7,0,"div",0)(2,Y,26,6)(3,Z,5,1,"div",1),o()),e&2&&(a(),x(n.loading()?1:n.user()?2:n.error()?3:-1))},dependencies:[L,F,z],encapsulation:2})};export{V as UserComponent};
