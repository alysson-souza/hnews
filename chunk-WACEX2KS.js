import{a as z}from"./chunk-SXXLH57T.js";import{a as W}from"./chunk-VGHO6HNJ.js";import{j as R}from"./chunk-NINWBLK3.js";import{a as O}from"./chunk-ALJNL3AC.js";import{$a as v,Ab as P,Bb as g,Ea as c,Ma as x,Sa as E,_ as y,_a as M,_b as S,ab as b,c as _,cb as k,cc as U,da as d,db as I,ea as m,fb as a,gb as n,ib as A,jb as V,lb as C,mb as B,na as u,nb as p,ob as D,pb as h,qb as $,rb as F,vb as j,wb as L,xb as T,yb as N,zb as r}from"./chunk-A2HHJ6P6.js";var q=["*"],w=class o{variant="primary";size="md";disabled=!1;fullWidth=!1;type="button";ariaLabel;pressed;clicked=new E;getButtonClasses(){let i="font-medium rounded transition-all duration-200 cursor-pointer focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2",e={sm:"px-3 py-1.5 text-sm",md:"px-4 py-2",lg:"px-6 py-3 text-lg"},t={primary:"bg-gradient-to-r from-blue-600 to-blue-700 text-white hover:from-blue-700 hover:to-blue-800 focus-visible:ring-blue-500",secondary:"bg-gray-200 text-gray-800 hover:bg-gray-300 focus-visible:ring-gray-500",danger:"bg-gradient-to-r from-red-600 to-red-700 text-white hover:from-red-700 hover:to-red-800 focus-visible:ring-red-500"},s=this.disabled?"opacity-50 cursor-not-allowed":"",l=this.fullWidth?"w-full":"";return`${i} ${e[this.size]} ${t[this.variant]} ${s} ${l}`.trim()}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=x({type:o,selectors:[["app-button"]],inputs:{variant:"variant",size:"size",disabled:"disabled",fullWidth:"fullWidth",type:"type",ariaLabel:"ariaLabel",pressed:"pressed"},outputs:{clicked:"clicked"},ngContentSelectors:q,decls:2,vars:6,consts:[[3,"click","type","disabled"]],template:function(e,t){e&1&&($(),A(0,"button",0),D("click",function(l){return t.clicked.emit(l)}),F(1),V()),e&2&&(N(t.getButtonClasses()),B("type",t.type)("disabled",t.disabled),M("aria-label",t.ariaLabel)("aria-pressed",t.pressed))},dependencies:[S],encapsulation:2})};var J=(o,i)=>i.username;function Q(o,i){if(o&1&&(a(0,"div",21),r(1),n()),o&2){let e=h();T("bg-green-100",!e.cacheError())("text-green-800",!e.cacheError())("bg-red-100",e.cacheError())("text-red-800",e.cacheError()),c(),g(" ",e.cacheMessage()," ")}}function X(o,i){if(o&1&&(a(0,"div",21),r(1),n()),o&2){let e=h();T("bg-green-100",!e.isError())("text-green-800",!e.isError())("bg-red-100",e.isError())("text-red-800",e.isError()),c(),g(" ",e.message()," ")}}function Y(o,i){if(o&1){let e=C();a(0,"div",22)(1,"div",23)(2,"span",24),r(3),n(),a(4,"span",25),r(5),n()(),a(6,"div",26)(7,"span"),r(8),n(),a(9,"button",27),p("click",function(){let s=d(e).$implicit,l=h(2);return m(l.removeTag(s.username))}),r(10," Remove "),n()()()}if(o&2){let e=i.$implicit,t=h(2);c(3),P(e.username),c(),L("background-color",e.color),c(),g(" ",e.tag," "),c(3),g("Added ",t.getTimeAgo(e.createdAt))}}function Z(o,i){if(o&1&&(a(0,"div",18),k(1,Y,11,5,"div",22,J),n()),o&2){let e=h();c(),I(e.tags())}}function ee(o,i){o&1&&(a(0,"p",19),r(1," No user tags yet. Tags will appear here when you tag users while browsing. "),n())}function te(o,i){if(o&1){let e=C();a(0,"div",20)(1,"app-button",11),p("clicked",function(){d(e);let s=h();return m(s.clearAll())}),r(2," Clear All Tags "),n()()}}var G=class o{tagsService=y(z);cacheService=y(U);tags=u([]);message=u("");isError=u(!1);cacheStats=u({indexedDB:0,swCache:0,itemCount:0,memoryItems:0});cacheMessage=u("");cacheError=u(!1);constructor(){this.loadTags()}ngOnInit(){return _(this,null,function*(){yield this.refreshStats()})}loadTags(){this.tags.set(this.tagsService.getAllTags())}exportTags(){let i=this.tagsService.exportTags(),e=new Blob([i],{type:"application/json"}),t=URL.createObjectURL(e),s=document.createElement("a");s.href=t,s.download=`hn-user-tags-${Date.now()}.json`,s.click(),URL.revokeObjectURL(t),this.showMessage("Tags exported successfully",!1)}importTags(i){let e=i.target,t=e.files?.[0];if(!t)return;let s=new FileReader;s.onload=l=>{let f=l.target?.result;this.tagsService.importTags(f)?(this.loadTags(),this.showMessage("Tags imported successfully",!1)):this.showMessage("Failed to import tags. Please check the file format.",!0)},s.readAsText(t),e.value=""}removeTag(i){this.tagsService.removeTag(i),this.loadTags(),this.showMessage(`Tag removed for ${i}`,!1)}clearAll(){confirm("Are you sure you want to clear all tags? This cannot be undone.")&&(this.tagsService.clearAllTags(),this.loadTags(),this.showMessage("All tags cleared",!1))}showMessage(i,e){this.message.set(i),this.isError.set(e),setTimeout(()=>this.message.set(""),3e3)}getTimeAgo(i){let e=Math.floor((Date.now()-i)/1e3),t=Math.floor(e/86400),s=Math.floor(e/3600),l=Math.floor(e/60);return t>0?`${t} day${t>1?"s":""} ago`:s>0?`${s} hour${s>1?"s":""} ago`:l>0?`${l} minute${l>1?"s":""} ago`:"just now"}refreshStats(){return _(this,null,function*(){try{let i=yield this.cacheService.getStats();this.cacheStats.set(i)}catch(i){console.error("Failed to get cache stats:",i),this.showCacheMessage("Failed to load cache statistics",!0)}})}clearCache(i){return _(this,null,function*(){try{if(i==="all"){if(!confirm("Clear all cached data? This will free up storage but may slow down loading temporarily."))return;yield this.cacheService.clearAll(),this.showCacheMessage("All cache cleared successfully",!1)}else i==="stories"?(yield this.cacheService.clearType("stories"),yield this.cacheService.clearType("storyLists"),this.showCacheMessage("Story cache cleared successfully",!1)):i==="images"&&("caches"in window&&(yield caches.delete("images-v1"),yield caches.delete("favicons-v1")),yield this.cacheService.clearType("opengraph"),this.showCacheMessage("Image cache cleared successfully",!1));yield this.refreshStats()}catch(e){console.error("Failed to clear cache:",e),this.showCacheMessage("Failed to clear cache",!0)}})}showCacheMessage(i,e){this.cacheMessage.set(i),this.cacheError.set(e),setTimeout(()=>this.cacheMessage.set(""),3e3)}formatBytes(i){if(i===0)return"0 B";let e=1024,t=["B","KB","MB","GB"],s=Math.floor(Math.log(i)/Math.log(e));return`${parseFloat((i/Math.pow(e,s)).toFixed(2))} ${t[s]}`}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=x({type:o,selectors:[["app-settings"]],decls:61,vars:9,consts:[["fileInput",""],["variant","narrow"],[1,"space-y-6"],[1,"block"],[1,"text-2xl","font-bold","text-gray-900","mb-6"],[1,"text-lg","font-semibold","text-gray-900","mb-4"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"bg-gray-50","p-4","rounded"],[1,"text-sm","text-gray-600"],[1,"text-xl","font-semibold","text-gray-900"],[1,"flex","flex-wrap","gap-4"],["variant","danger",3,"clicked"],["variant","secondary",3,"clicked"],["variant","primary",3,"clicked"],[1,"p-3","rounded",3,"bg-green-100","text-green-800","bg-red-100","text-red-800"],[1,"mb-8","space-y-4"],[1,"flex","gap-4"],["type","file","accept",".json",1,"hidden",3,"change"],[1,"space-y-2"],[1,"text-gray-500","text-center","py-8"],[1,"mt-6","pt-6","border-t","border-gray-200"],[1,"p-3","rounded"],[1,"flex","items-center","justify-between","p-3","bg-gray-50","rounded"],[1,"flex","items-center","gap-3"],[1,"font-medium","text-gray-900"],[1,"px-2","py-1","text-xs","text-white","rounded"],[1,"flex","items-center","gap-4","text-sm","text-gray-600"],[1,"text-red-600","hover:text-red-800","cursor-pointer","focus-visible:outline-none","focus-visible:ring-2","focus-visible:ring-red-500","rounded","px-1",3,"click"]],template:function(e,t){if(e&1){let s=C();a(0,"app-page-container",1)(1,"div",2)(2,"app-card",3)(3,"h1",4),r(4,"Cache Management"),n(),a(5,"div",2)(6,"div")(7,"h2",5),r(8,"Cache Statistics"),n(),a(9,"div",6)(10,"div",7)(11,"div",8),r(12,"IndexedDB Storage"),n(),a(13,"div",9),r(14),n()(),a(15,"div",7)(16,"div",8),r(17,"Service Worker Cache"),n(),a(18,"div",9),r(19),n()(),a(20,"div",7)(21,"div",8),r(22,"Total Items Cached"),n(),a(23,"div",9),r(24),n()(),a(25,"div",7)(26,"div",8),r(27,"Memory Cache"),n(),a(28,"div",9),r(29),n()()()(),a(30,"div")(31,"h2",5),r(32,"Cache Actions"),n(),a(33,"div",10)(34,"app-button",11),p("clicked",function(){return d(s),m(t.clearCache("all"))}),r(35," Clear All Cache "),n(),a(36,"app-button",12),p("clicked",function(){return d(s),m(t.clearCache("stories"))}),r(37," Clear Stories "),n(),a(38,"app-button",12),p("clicked",function(){return d(s),m(t.clearCache("images"))}),r(39," Clear Images "),n(),a(40,"app-button",13),p("clicked",function(){return d(s),m(t.refreshStats())}),r(41," Refresh Stats "),n()()(),v(42,Q,2,9,"div",14),n()(),a(43,"app-card",3)(44,"h2",4),r(45,"User Tags Management"),n(),a(46,"div",15)(47,"div",16)(48,"app-button",13),p("clicked",function(){return d(s),m(t.exportTags())}),r(49," Export Tags "),n(),a(50,"app-button",13),p("clicked",function(){d(s);let f=j(53);return m(f.click())}),r(51," Import Tags "),n(),a(52,"input",17,0),p("change",function(f){return d(s),m(t.importTags(f))}),n()(),v(54,X,2,9,"div",14),n(),a(55,"div")(56,"h2",5),r(57),n(),v(58,Z,3,0,"div",18)(59,ee,2,0,"p",19),n(),v(60,te,3,0,"div",20),n()()()}e&2&&(c(14),g(" ",t.formatBytes(t.cacheStats().indexedDB)," "),c(5),g(" ",t.formatBytes(t.cacheStats().swCache)," "),c(5),g(" ",t.cacheStats().itemCount," "),c(5),g(" ",t.cacheStats().memoryItems," items "),c(13),b(t.cacheMessage()?42:-1),c(12),b(t.message()?54:-1),c(3),g(" Current Tags (",t.tags().length,") "),c(),b(t.tags().length>0?58:59),c(2),b(t.tags().length>0?60:-1))},dependencies:[S,R,w,W,O],encapsulation:2})};export{G as SettingsComponent};
