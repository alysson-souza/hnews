import{c as V}from"./chunk-ERUKNYRP.js";import{a as H}from"./chunk-FOEJSIVQ.js";import"./chunk-VDCQTW6J.js";import{b as L,e as D,h as N}from"./chunk-4HRH523E.js";import"./chunk-XJYKXWCC.js";import"./chunk-NZ6SU7RA.js";import{a as B}from"./chunk-IJG6HO3S.js";import{a as $}from"./chunk-QXV24GXU.js";import{Ca as I,Kb as z,Oa as d,Pa as g,Qa as O,Ra as S,Sa as T,Ta as p,Ua as i,Va as r,Wa as u,_ as w,_a as _,ab as x,ca as f,cb as c,da as b,ea as y,la as h,nb as l,ob as k,pb as m,ra as M,sa as P,ub as E,wa as a,yb as v}from"./chunk-SJE556VZ.js";var q=t=>["/user",t];function F(t,n){t&1&&(i(0,"div",0),u(1,"div",2)(2,"div",3),i(3,"div",4),u(4,"div",5)(5,"div",5),r()())}function j(t,n){if(t&1&&(i(0,"a",8),l(1),r()),t&2){let e=c(2);p("href",e.item().url,P),a(),m(" ",e.item().title," ")}}function G(t,n){if(t&1&&l(0),t&2){let e=c(2);m(" ",e.item().title," ")}}function U(t,n){if(t&1&&u(0,"div",11),t&2){let e=c(2);p("innerHTML",e.item().text,M)}}function Y(t,n){if(t&1&&u(0,"app-comment-thread",15),t&2){let e=n.$implicit,o=n.$index,s=c(3);p("commentId",e)("depth",0)("lazyLoad",s.shouldLazyLoad(o))}}function J(t,n){t&1&&(i(0,"span",18),y(),i(1,"svg",19),u(2,"circle",20)(3,"path",21),r(),l(4," Loading... "),r())}function K(t,n){if(t&1&&l(0),t&2){let e=c(4);m(" Load ",e.nextBatchSize()," more comments ")}}function Q(t,n){if(t&1){let e=_();i(0,"div",16)(1,"button",17),x("click",function(){f(e);let s=c(3);return b(s.loadMoreComments())}),d(2,J,5,0,"span",18)(3,K,1,1),r()()}if(t&2){let e=c(3);a(),p("disabled",e.loadingMoreComments()),a(),g(e.loadingMoreComments()?2:3)}}function W(t,n){if(t&1&&(i(0,"div",4),S(1,Y,1,3,"app-comment-thread",15,O),r(),d(3,Q,4,2,"div",16)),t&2){let e=c(2);a(),T(e.visibleComments()),a(2),g(e.hasMoreComments()?3:-1)}}function X(t,n){t&1&&(i(0,"p",14),l(1,"No comments yet"),r())}function Z(t,n){if(t&1&&(i(0,"app-card",6)(1,"h1",7),d(2,j,2,2,"a",8)(3,G,1,1),r(),i(4,"div",9)(5,"span"),l(6),r(),i(7,"span"),l(8,"\u2022"),r(),i(9,"span"),l(10,"by "),i(11,"a",10),l(12),r()(),i(13,"span"),l(14,"\u2022"),r(),i(15,"span"),l(16),r(),i(17,"span"),l(18,"\u2022"),r(),i(19,"span"),l(20),r()(),d(21,U,1,1,"div",11),r(),i(22,"app-card",12)(23,"h2",13),l(24),r(),d(25,W,4,1)(26,X,2,0,"p",14),r()),t&2){let e=c();a(2),g(e.item().url?2:3),a(4),m("",e.item().score||0," points"),a(5),p("routerLink",E(9,q,e.item().by)),a(),m(" ",e.item().by," "),a(4),k(e.getTimeAgo(e.item().time)),a(4),m("",e.item().descendants||0," comments"),a(),g(e.item().text?21:-1),a(3),m("Comments (",e.item().descendants||0,")"),a(),g(e.visibleComments().length>0?25:26)}}function ee(t,n){if(t&1){let e=_();i(0,"div",1)(1,"p",22),l(2),r(),i(3,"button",23),x("click",function(){f(e);let s=c();return b(s.loadItem())}),l(4,"Try Again"),r()()}if(t&2){let e=c();a(2),k(e.error())}}var A=class t{route=w(L);hnService=w(N);visitedService=w(H);item=h(null);loading=h(!0);error=h(null);commentsPerPage=10;immediateLoadCount=3;maxInitialComments=3;currentCommentsPage=h(0);loadingMoreComments=h(!1);visibleComments=v(()=>{let n=this.item();if(!n?.kids)return[];if(this.currentCommentsPage()===0)return n.kids.slice(0,this.maxInitialComments);let e=this.maxInitialComments+this.currentCommentsPage()*this.commentsPerPage;return n.kids.slice(0,e)});hasMoreComments=v(()=>{let n=this.item();if(!n?.kids)return!1;let e=n.kids.length;return(this.currentCommentsPage()===0?this.maxInitialComments:this.maxInitialComments+this.currentCommentsPage()*this.commentsPerPage)<e});remainingCommentsCount=v(()=>{let n=this.item();if(!n?.kids)return 0;let e=n.kids.length,o=this.currentCommentsPage()===0?this.maxInitialComments:this.maxInitialComments+this.currentCommentsPage()*this.commentsPerPage;return Math.max(0,e-o)});nextBatchSize=v(()=>Math.min(this.commentsPerPage,this.remainingCommentsCount()));shouldLazyLoad(n){return n>=this.immediateLoadCount}ngOnInit(){this.route.params.subscribe(n=>{let e=n.id;e?this.loadItem(+e):this.route.queryParams.subscribe(o=>{let s=o.id;s&&this.loadItem(+s)})})}loadItem(n){let e=n||+this.route.snapshot.params.id;if(!e){this.error.set("Invalid item ID"),this.loading.set(!1);return}this.loading.set(!0),this.error.set(null),this.currentCommentsPage.set(0),this.hnService.getItem(e).subscribe({next:o=>{o?(this.item.set(o),this.visitedService.markAsVisited(o.id,o.descendants),setTimeout(()=>{let s=document.getElementById("submission-title");if(s){let R=s.getBoundingClientRect().top+window.scrollY-80;window.scrollTo({top:Math.max(0,R),behavior:"smooth"})}},100)):this.error.set("Item not found"),this.loading.set(!1)},error:()=>{this.error.set("Failed to load item. Please try again."),this.loading.set(!1)}})}loadMoreComments(){this.loadingMoreComments()||!this.hasMoreComments()||(this.loadingMoreComments.set(!0),setTimeout(()=>{this.currentCommentsPage.update(n=>n+1),this.loadingMoreComments.set(!1)},300))}getTimeAgo(n){let e=Math.floor(Date.now()/1e3-n),o=Math.floor(e/60),s=Math.floor(o/60),C=Math.floor(s/24);return C>0?`${C} day${C>1?"s":""} ago`:s>0?`${s} hour${s>1?"s":""} ago`:o>0?`${o} minute${o>1?"s":""} ago`:"just now"}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=I({type:t,selectors:[["app-item"]],decls:4,vars:1,consts:[[1,"animate-pulse"],[1,"error-card"],[1,"skel-title","mb-4"],[1,"skel-subtitle","mb-8"],[1,"space-y-4"],[1,"skel-block"],["id","submission-title",1,"block","mb-6"],[1,"item-title"],["target","_blank","rel","noopener noreferrer nofollow",1,"title-link",3,"href"],[1,"item-meta","mb-4"],[1,"meta-link",3,"routerLink"],[1,"item-prose",3,"innerHTML"],[1,"block"],[1,"comments-title"],[1,"empty"],[3,"commentId","depth","lazyLoad"],[1,"mt-8","text-center"],[1,"comments-load-btn",3,"click","disabled"],[1,"flex","items-center","gap-2"],["fill","none","viewBox","0 0 24 24",1,"w-4","h-4","animate-spin"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"],[1,"error-text"],[1,"error-btn",3,"click"]],template:function(e,o){e&1&&(i(0,"app-page-container"),d(1,F,6,0,"div",0)(2,Z,27,11)(3,ee,5,1,"div",1),r()),e&2&&(a(),g(o.loading()?1:o.item()?2:o.error()?3:-1))},dependencies:[z,V,D,$,B],styles:[`@layer properties;.skel-title[_ngcontent-%COMP%]{height:calc(var(--spacing, .25rem) * 8);width:75%;border-radius:.25rem;background-color:var(--color-gray-200, oklch(92.8% .006 264.531))}.skel-title[_ngcontent-%COMP%]:where(.dark,.dark *){background-color:var(--color-slate-800, oklch(27.9% .041 260.031))}.skel-subtitle[_ngcontent-%COMP%]{height:calc(var(--spacing, .25rem) * 4);width:50%;border-radius:.25rem;background-color:var(--color-gray-200, oklch(92.8% .006 264.531))}.skel-subtitle[_ngcontent-%COMP%]:where(.dark,.dark *){background-color:var(--color-slate-800, oklch(27.9% .041 260.031))}.skel-block[_ngcontent-%COMP%]{height:calc(var(--spacing, .25rem) * 20);border-radius:.25rem;background-color:var(--color-gray-200, oklch(92.8% .006 264.531))}.skel-block[_ngcontent-%COMP%]:where(.dark,.dark *){background-color:var(--color-slate-800, oklch(27.9% .041 260.031))}.item-title[_ngcontent-%COMP%]{margin-bottom:calc(var(--spacing, .25rem) * 2);font-size:var(--text-2xl, 1.5rem);line-height:var(--tw-leading, var(--text-2xl--line-height, calc(2 / 1.5)));--tw-font-weight: var(--font-weight-bold, 700);font-weight:var(--font-weight-bold, 700);color:var(--color-gray-900, oklch(21% .034 264.665))}.item-title[_ngcontent-%COMP%]:where(.dark,.dark *){color:var(--color-gray-100, oklch(96.7% .003 264.542))}.comments-title[_ngcontent-%COMP%]{margin-bottom:calc(var(--spacing, .25rem) * 4);font-size:var(--text-xl, 1.25rem);line-height:var(--tw-leading, var(--text-xl--line-height, calc(1.75 / 1.25)));--tw-font-weight: var(--font-weight-semibold, 600);font-weight:var(--font-weight-semibold, 600);color:var(--color-gray-900, oklch(21% .034 264.665))}.comments-title[_ngcontent-%COMP%]:where(.dark,.dark *){color:var(--color-gray-100, oklch(96.7% .003 264.542))}@media (hover: hover){.title-link[_ngcontent-%COMP%]:hover{color:var(--color-blue-600, oklch(54.6% .245 262.881))}}@media (hover: hover){.title-link[_ngcontent-%COMP%]:where(.dark,.dark *):hover{color:var(--color-blue-400, oklch(70.7% .165 254.624))}}.item-meta[_ngcontent-%COMP%]{display:flex;align-items:center;gap:calc(var(--spacing, .25rem) * 3);font-size:var(--text-sm, .875rem);line-height:var(--tw-leading, var(--text-sm--line-height, calc(1.25 / .875)));color:var(--color-gray-600, oklch(44.6% .03 256.802))}.item-meta[_ngcontent-%COMP%]:where(.dark,.dark *){color:var(--color-gray-400, oklch(70.7% .022 261.325))}.meta-link[_ngcontent-%COMP%]{color:var(--color-blue-600, oklch(54.6% .245 262.881))}@media (hover: hover){.meta-link[_ngcontent-%COMP%]:hover{text-decoration-line:underline}}.meta-link[_ngcontent-%COMP%]:where(.dark,.dark *){color:var(--color-blue-300, oklch(80.9% .105 251.813))}.item-prose[_ngcontent-%COMP%]{margin-bottom:calc(var(--spacing, .25rem) * 4);color:var(--tw-prose-body);max-width:65ch;--tw-prose-body: #374151;--tw-prose-headings: #111827;--tw-prose-lead: #4b5563;--tw-prose-links: #111827;--tw-prose-bold: #111827;--tw-prose-counters: #6b7280;--tw-prose-bullets: #d1d5db;--tw-prose-hr: #e5e7eb;--tw-prose-quotes: #111827;--tw-prose-quote-borders: #e5e7eb;--tw-prose-captions: #6b7280;--tw-prose-code: #111827;--tw-prose-pre-code: #e5e7eb;--tw-prose-pre-bg: #1f2937;--tw-prose-th-borders: #d1d5db;--tw-prose-td-borders: #e5e7eb;max-width:none;font-size:1.125rem;line-height:1.7777778;color:var(--color-gray-800, oklch(27.8% .033 256.848))}.item-prose[_ngcontent-%COMP%]:where(.dark,.dark *){color:var(--color-gray-200, oklch(92.8% .006 264.531))}.comments-load-btn[_ngcontent-%COMP%]{cursor:pointer;border-radius:var(--radius-lg, .5rem);background-color:var(--color-blue-600, oklch(54.6% .245 262.881));padding-inline:calc(var(--spacing, .25rem) * 6);padding-block:calc(var(--spacing, .25rem) * 3);color:var(--color-white, #fff);transition-property:color,background-color,border-color,outline-color,text-decoration-color,fill,stroke,--tw-gradient-from,--tw-gradient-via,--tw-gradient-to;transition-timing-function:var(--tw-ease, var(--default-transition-timing-function, cubic-bezier(.4, 0, .2, 1)));transition-duration:var(--tw-duration, var(--default-transition-duration, .15s))}@media (hover: hover){.comments-load-btn[_ngcontent-%COMP%]:hover{background-color:var(--color-blue-700, oklch(48.8% .243 264.376))}}.comments-load-btn[_ngcontent-%COMP%]:focus-visible{--tw-ring-shadow: var(--tw-ring-inset,) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color, currentcolor);box-shadow:var(--tw-inset-shadow),var(--tw-inset-ring-shadow),var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow)}.comments-load-btn[_ngcontent-%COMP%]:focus-visible{--tw-ring-color: var(--color-blue-500, oklch(62.3% .214 259.815))}.comments-load-btn[_ngcontent-%COMP%]:focus-visible{--tw-outline-style: none;outline-style:none}.comments-load-btn[_ngcontent-%COMP%]:disabled{cursor:not-allowed}.comments-load-btn[_ngcontent-%COMP%]:disabled{background-color:var(--color-blue-400, oklch(70.7% .165 254.624))}.empty[_ngcontent-%COMP%]{padding-block:calc(var(--spacing, .25rem) * 8);text-align:center;color:var(--color-gray-500, oklch(55.1% .027 264.364))}.empty[_ngcontent-%COMP%]:where(.dark,.dark *){color:var(--color-gray-400, oklch(70.7% .022 261.325))}.error-card[_ngcontent-%COMP%]{border-radius:var(--radius-lg, .5rem);border-style:var(--tw-border-style);border-width:1px;border-color:var(--color-red-200, oklch(88.5% .062 18.334));background-color:var(--color-red-50, oklch(97.1% .013 17.38));padding:calc(var(--spacing, .25rem) * 6);text-align:center}.error-card[_ngcontent-%COMP%]:where(.dark,.dark *){border-color:var(--color-red-800, oklch(44.4% .177 26.899))}.error-card[_ngcontent-%COMP%]:where(.dark,.dark *){background-color:color-mix(in srgb,oklch(39.6% .141 25.723) 30%,transparent)}@supports (color: color-mix(in lab,red,red)){.error-card[_ngcontent-%COMP%]:where(.dark,.dark *){background-color:color-mix(in oklab,var(--color-red-900, oklch(39.6% .141 25.723)) 30%,transparent)}}.error-text[_ngcontent-%COMP%]{color:var(--color-red-800, oklch(44.4% .177 26.899))}.error-text[_ngcontent-%COMP%]:where(.dark,.dark *){color:var(--color-red-300, oklch(80.8% .114 19.571))}.error-btn[_ngcontent-%COMP%]{margin-top:calc(var(--spacing, .25rem) * 4);border-radius:.25rem;background-color:var(--color-red-600, oklch(57.7% .245 27.325));padding-inline:calc(var(--spacing, .25rem) * 4);padding-block:calc(var(--spacing, .25rem) * 2);color:var(--color-white, #fff)}@media (hover: hover){.error-btn[_ngcontent-%COMP%]:hover{background-color:var(--color-red-700, oklch(50.5% .213 27.518))}}.error-btn[_ngcontent-%COMP%]:focus-visible{--tw-ring-shadow: var(--tw-ring-inset,) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color, currentcolor);box-shadow:var(--tw-inset-shadow),var(--tw-inset-ring-shadow),var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow)}.error-btn[_ngcontent-%COMP%]:focus-visible{--tw-ring-color: var(--color-red-500, oklch(63.7% .237 25.331))}.error-btn[_ngcontent-%COMP%]:focus-visible{--tw-outline-style: none;outline-style:none}@property --tw-font-weight{syntax: "*"; inherits: false;}@property --tw-shadow{syntax: "*"; inherits: false; initial-value: 0 0 #0000;}@property --tw-shadow-color{syntax: "*"; inherits: false;}@property --tw-shadow-alpha{syntax: "<percentage>"; inherits: false; initial-value: 100%;}@property --tw-inset-shadow{syntax: "*"; inherits: false; initial-value: 0 0 #0000;}@property --tw-inset-shadow-color{syntax: "*"; inherits: false;}@property --tw-inset-shadow-alpha{syntax: "<percentage>"; inherits: false; initial-value: 100%;}@property --tw-ring-color{syntax: "*"; inherits: false;}@property --tw-ring-shadow{syntax: "*"; inherits: false; initial-value: 0 0 #0000;}@property --tw-inset-ring-color{syntax: "*"; inherits: false;}@property --tw-inset-ring-shadow{syntax: "*"; inherits: false; initial-value: 0 0 #0000;}@property --tw-ring-inset{syntax: "*"; inherits: false;}@property --tw-ring-offset-width{syntax: "<length>"; inherits: false; initial-value: 0px;}@property --tw-ring-offset-color{syntax: "*"; inherits: false; initial-value: #fff;}@property --tw-ring-offset-shadow{syntax: "*"; inherits: false; initial-value: 0 0 #0000;}@property --tw-border-style{syntax: "*"; inherits: false; initial-value: solid;}@layer properties{@supports ((-webkit-hyphens: none) and (not (margin-trim: inline))) or ((-moz-orient: inline) and (not (color:rgb(from red r g b)))){*[_ngcontent-%COMP%], [_ngcontent-%COMP%]:before, [_ngcontent-%COMP%]:after, [_ngcontent-%COMP%]::backdrop{--tw-font-weight: initial;--tw-shadow: 0 0 #0000;--tw-shadow-color: initial;--tw-shadow-alpha: 100%;--tw-inset-shadow: 0 0 #0000;--tw-inset-shadow-color: initial;--tw-inset-shadow-alpha: 100%;--tw-ring-color: initial;--tw-ring-shadow: 0 0 #0000;--tw-inset-ring-color: initial;--tw-inset-ring-shadow: 0 0 #0000;--tw-ring-inset: initial;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-offset-shadow: 0 0 #0000;--tw-border-style: solid}}}

`]})};export{A as ItemComponent};
