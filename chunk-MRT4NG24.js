import{e as D}from"./chunk-RUJMMPOU.js";import{a as z,b as L,c as G,g as K}from"./chunk-6R2GPWYH.js";import{a as A,b as F,e as N,j as R}from"./chunk-FRAC5L3Y.js";import{$ as x,Da as y,Pb as I,Qa as g,Ra as m,Sa as h,W as b,Wa as _,Xa as u,Ya as d,Za as T,bb as v,da as a,db as p,ea as s,fb as o,jb as M,kb as k,lb as V,ma as f,nb as O,qb as w,sb as C,ub as E,vb as P,wb as S,xa as l,yb as U}from"./chunk-YMVQ6C4T.js";var Q=class r{STORAGE_KEY="hn_visited_stories";MAX_VISITED=1e3;visitedMap=new Map;constructor(){this.loadVisited()}loadVisited(){try{let t=localStorage.getItem(this.STORAGE_KEY);t&&JSON.parse(t).forEach(i=>this.visitedMap.set(i.storyId,i))}catch(t){console.error("Failed to load visited stories:",t)}}saveVisited(){try{let t=Array.from(this.visitedMap.values()).sort((e,i)=>i.visitedAt-e.visitedAt).slice(0,this.MAX_VISITED);localStorage.setItem(this.STORAGE_KEY,JSON.stringify(t))}catch(t){console.error("Failed to save visited stories:",t)}}markAsVisited(t,e){let i=this.visitedMap.get(t),n={storyId:t,visitedAt:Date.now(),commentCount:e??i?.commentCount};this.visitedMap.set(t,n),this.saveVisited()}isVisited(t){return this.visitedMap.has(t)}getVisitedData(t){return this.visitedMap.get(t)}hasNewComments(t,e){let i=this.visitedMap.get(t);return!i||i.commentCount===void 0?!1:e>i.commentCount}getNewCommentCount(t,e){let i=this.visitedMap.get(t);return!i||i.commentCount===void 0?0:Math.max(0,e-i.commentCount)}clearVisited(){this.visitedMap.clear(),localStorage.removeItem(this.STORAGE_KEY)}static \u0275fac=function(e){return new(e||r)};static \u0275prov=b({token:r,factory:r.\u0275fac,providedIn:"root"})};var B=["tagInput"],W=r=>["/user",r];function J(r,t){if(r&1){let e=v();u(0,"button",6),p("click",function(n){a(e);let c=o();return s(c.startEdit(n))})("keyup.enter",function(n){a(e);let c=o();return s(c.startEdit(n))})("keyup.space",function(n){a(e);let c=o();return s(c.startEdit(n))}),w(1),d()}if(r&2){let e=o();O("background-color",e.tag().color),g("aria-label","Tag: "+e.tag().tag),l(),C(" ",e.tag().tag," ")}}function X(r,t){if(r&1){let e=v();u(0,"button",7),p("click",function(n){a(e);let c=o();return s(c.startEdit(n))}),T(1,"fa-icon",8),d()}if(r&2){let e=o();g("aria-label","Add Tag For "+e.username),l(),_("icon",e.faUserTag)}}function q(r,t){if(r&1){let e=v();u(0,"button",12),p("click",function(){a(e);let n=o(2);return s(n.removeTag())}),w(1," \u2717 "),d()}r&2&&g("aria-label","Remove Tag")}function H(r,t){if(r&1){let e=v();u(0,"div",5)(1,"input",9,0),S("ngModelChange",function(n){a(e);let c=o();return P(c.editValue,n)||(c.editValue=n),s(n)}),p("keyup.enter",function(){a(e);let n=o();return s(n.saveTag())})("keyup.escape",function(){a(e);let n=o();return s(n.cancelEdit())})("blur",function(){a(e);let n=o();return s(n.onInputBlur())}),d(),u(3,"button",10),p("mousedown",function(){a(e);let n=o();return s(n.saveTag())}),w(4,"\u2713"),d(),m(5,q,2,1,"button",11),d()}if(r&2){let e=o();l(),E("ngModel",e.editValue),g("aria-label","Enter Tag For "+e.username),l(2),g("aria-label","Save Tag"),l(2),h(e.tag()?5:-1)}}var Y=class r{_username="";set username(t){this._username=t,this.tag.set(this.tagsService.getTag(t))}get username(){return this._username}tagsService=x(z);tag=f(void 0);editing=f(!1);editValue="";faUserTag=K;tagInput;startEdit(t){t.preventDefault(),t.stopPropagation(),this.editing.set(!0),this.editValue=this.tag()?.tag||"",setTimeout(()=>{let e=this.tagInput?.nativeElement;e?.focus(),e?.select()},0)}saveTag(){let t=this.editValue.trim();t?(this.tagsService.setTag(this.username,t),this.tag.set(this.tagsService.getTag(this.username))):this.tag()&&(this.tagsService.removeTag(this.username),this.tag.set(void 0)),this.editing.set(!1),this.editValue=""}removeTag(){this.tagsService.removeTag(this.username),this.tag.set(void 0),this.editing.set(!1),this.editValue=""}onInputBlur(){setTimeout(()=>{this.editing()&&this.cancelEdit()},100)}cancelEdit(){this.editing.set(!1),this.editValue=""}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=y({type:r,selectors:[["app-user-tag"]],viewQuery:function(e,i){if(e&1&&M(B,5),e&2){let n;k(n=V())&&(i.tagInput=n.first)}},inputs:{username:"username"},decls:6,vars:8,consts:[["tagInput",""],[1,"user-tag"],[1,"username-link",3,"routerLink"],["type","button",1,"tag-chip",3,"background-color"],[1,"add-btn"],[1,"editor"],["type","button",1,"tag-chip",3,"click","keyup.enter","keyup.space"],[1,"add-btn",3,"click"],[1,"icon",3,"icon"],["type","text","placeholder","Tag...",1,"tag-input",3,"ngModelChange","keyup.enter","keyup.escape","blur","ngModel"],[1,"save-btn",3,"mousedown"],[1,"remove-btn"],[1,"remove-btn",3,"click"]],template:function(e,i){e&1&&(u(0,"span",1)(1,"a",2),w(2),d(),m(3,J,2,4,"button",3),m(4,X,2,2,"button",4),m(5,H,6,4,"div",5),d()),e&2&&(l(),_("routerLink",U(6,W,i.username)),g("aria-label","View Profile Of "+i.username),l(),C(" ",i.username," "),l(),h(i.tag()&&!i.editing()?3:-1),l(),h(!i.tag()&&!i.editing()?4:-1),l(),h(i.editing()?5:-1))},dependencies:[I,R,A,F,N,D,G,L],styles:[`@layer properties;.user-tag[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:calc(var(--spacing, .25rem) * 1)}.username-link[_ngcontent-%COMP%]{cursor:pointer;color:var(--color-blue-600, oklch(54.6% .245 262.881));border-radius:.25rem}@media (hover: hover){.username-link[_ngcontent-%COMP%]:hover{text-decoration-line:underline}}.username-link[_ngcontent-%COMP%]:where(.dark,.dark *){color:var(--color-blue-300, oklch(80.9% .105 251.813))}.username-link[_ngcontent-%COMP%]:focus-visible{--tw-ring-shadow: var(--tw-ring-inset,) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color, currentcolor);box-shadow:var(--tw-inset-shadow),var(--tw-inset-ring-shadow),var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow)}.username-link[_ngcontent-%COMP%]:focus-visible{--tw-ring-color: var(--color-blue-500, oklch(62.3% .214 259.815))}.username-link[_ngcontent-%COMP%]:focus-visible{--tw-outline-style: none;outline-style:none}.tag-chip[_ngcontent-%COMP%]{cursor:pointer;border-radius:.25rem;padding-inline:calc(var(--spacing, .25rem) * 1.5);padding-block:calc(var(--spacing, .25rem) * .5);font-size:var(--text-xs, .75rem);line-height:var(--tw-leading, var(--text-xs--line-height, calc(1 / .75)));color:var(--color-white, #fff)}.add-btn[_ngcontent-%COMP%]{cursor:pointer;font-size:var(--text-xs, .75rem);line-height:var(--tw-leading, var(--text-xs--line-height, calc(1 / .75)));color:var(--color-gray-400, oklch(70.7% .022 261.325));border-radius:.25rem;padding-inline:calc(var(--spacing, .25rem) * 1)}@media (hover: hover){.add-btn[_ngcontent-%COMP%]:hover{color:var(--color-gray-600, oklch(44.6% .03 256.802))}}.add-btn[_ngcontent-%COMP%]:focus-visible{--tw-ring-shadow: var(--tw-ring-inset,) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color, currentcolor);box-shadow:var(--tw-inset-shadow),var(--tw-inset-ring-shadow),var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow)}.add-btn[_ngcontent-%COMP%]:focus-visible{--tw-ring-color: var(--color-blue-500, oklch(62.3% .214 259.815))}.add-btn[_ngcontent-%COMP%]:focus-visible{--tw-outline-style: none;outline-style:none}.icon[_ngcontent-%COMP%]{vertical-align:-2px}.editor[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:calc(var(--spacing, .25rem) * 1)}.tag-input[_ngcontent-%COMP%]{width:calc(var(--spacing, .25rem) * 20);border-radius:.25rem;border-style:var(--tw-border-style);border-width:1px;border-color:var(--color-gray-300, oklch(87.2% .01 258.338));padding-inline:calc(var(--spacing, .25rem) * 1);padding-block:calc(var(--spacing, .25rem) * 0);font-size:var(--text-xs, .75rem);line-height:var(--tw-leading, var(--text-xs--line-height, calc(1 / .75)))}.tag-input[_ngcontent-%COMP%]:focus{--tw-ring-shadow: var(--tw-ring-inset,) 0 0 0 calc(1px + var(--tw-ring-offset-width)) var(--tw-ring-color, currentcolor);box-shadow:var(--tw-inset-shadow),var(--tw-inset-ring-shadow),var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow)}.tag-input[_ngcontent-%COMP%]:focus{--tw-ring-color: var(--color-blue-500, oklch(62.3% .214 259.815))}.tag-input[_ngcontent-%COMP%]:focus{--tw-outline-style: none;outline-style:none}.save-btn[_ngcontent-%COMP%]{cursor:pointer;font-size:var(--text-xs, .75rem);line-height:var(--tw-leading, var(--text-xs--line-height, calc(1 / .75)));color:var(--color-green-600, oklch(62.7% .194 149.214))}@media (hover: hover){.save-btn[_ngcontent-%COMP%]:hover{color:var(--color-green-800, oklch(44.8% .119 151.328))}}.remove-btn[_ngcontent-%COMP%]{cursor:pointer;font-size:var(--text-xs, .75rem);line-height:var(--tw-leading, var(--text-xs--line-height, calc(1 / .75)));color:var(--color-red-600, oklch(57.7% .245 27.325))}@media (hover: hover){.remove-btn[_ngcontent-%COMP%]:hover{color:var(--color-red-800, oklch(44.4% .177 26.899))}}@property --tw-shadow{syntax: "*"; inherits: false; initial-value: 0 0 #0000;}@property --tw-shadow-color{syntax: "*"; inherits: false;}@property --tw-shadow-alpha{syntax: "<percentage>"; inherits: false; initial-value: 100%;}@property --tw-inset-shadow{syntax: "*"; inherits: false; initial-value: 0 0 #0000;}@property --tw-inset-shadow-color{syntax: "*"; inherits: false;}@property --tw-inset-shadow-alpha{syntax: "<percentage>"; inherits: false; initial-value: 100%;}@property --tw-ring-color{syntax: "*"; inherits: false;}@property --tw-ring-shadow{syntax: "*"; inherits: false; initial-value: 0 0 #0000;}@property --tw-inset-ring-color{syntax: "*"; inherits: false;}@property --tw-inset-ring-shadow{syntax: "*"; inherits: false; initial-value: 0 0 #0000;}@property --tw-ring-inset{syntax: "*"; inherits: false;}@property --tw-ring-offset-width{syntax: "<length>"; inherits: false; initial-value: 0px;}@property --tw-ring-offset-color{syntax: "*"; inherits: false; initial-value: #fff;}@property --tw-ring-offset-shadow{syntax: "*"; inherits: false; initial-value: 0 0 #0000;}@property --tw-border-style{syntax: "*"; inherits: false; initial-value: solid;}@layer properties{@supports ((-webkit-hyphens: none) and (not (margin-trim: inline))) or ((-moz-orient: inline) and (not (color:rgb(from red r g b)))){*[_ngcontent-%COMP%], [_ngcontent-%COMP%]:before, [_ngcontent-%COMP%]:after, [_ngcontent-%COMP%]::backdrop{--tw-shadow: 0 0 #0000;--tw-shadow-color: initial;--tw-shadow-alpha: 100%;--tw-inset-shadow: 0 0 #0000;--tw-inset-shadow-color: initial;--tw-inset-shadow-alpha: 100%;--tw-ring-color: initial;--tw-ring-shadow: 0 0 #0000;--tw-inset-ring-color: initial;--tw-inset-ring-shadow: 0 0 #0000;--tw-ring-inset: initial;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-offset-shadow: 0 0 #0000;--tw-border-style: solid}}}

`],changeDetection:0})};export{Y as a,Q as b};
