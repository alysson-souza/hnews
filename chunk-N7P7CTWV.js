import{R as o,ha as r}from"./chunk-F3RLHTIL.js";var d=class a{STORAGE_KEY="hn_visited_stories";MAX_VISITED=1e3;visitedMap=r(new Map);constructor(){this.loadVisited()}loadVisited(){try{let t=localStorage.getItem(this.STORAGE_KEY);if(t){let i=JSON.parse(t),e=new Map;i.forEach(s=>e.set(s.storyId,s)),this.visitedMap.set(e)}}catch(t){console.error("Failed to load visited stories:",t)}}saveVisited(){try{let t=Array.from(this.visitedMap().values()).sort((i,e)=>e.visitedAt-i.visitedAt).slice(0,this.MAX_VISITED);localStorage.setItem(this.STORAGE_KEY,JSON.stringify(t))}catch(t){console.error("Failed to save visited stories:",t)}}markAsVisited(t,i){let e=this.visitedMap(),s=e.get(t),c={storyId:t,visitedAt:Date.now(),commentCount:i??s?.commentCount},n=new Map(e);n.set(t,c),this.visitedMap.set(n),this.saveVisited()}isVisited(t){return this.visitedMap().has(t)}getVisitedData(t){return this.visitedMap().get(t)}hasNewComments(t,i){let e=this.visitedMap().get(t);return!e||e.commentCount===void 0?!1:i>e.commentCount}getNewCommentCount(t,i){let e=this.visitedMap().get(t);return!e||e.commentCount===void 0?0:Math.max(0,i-e.commentCount)}clearVisited(){this.visitedMap.set(new Map),localStorage.removeItem(this.STORAGE_KEY)}static \u0275fac=function(i){return new(i||a)};static \u0275prov=o({token:a,factory:a.\u0275fac,providedIn:"root"})};export{d as a};
